<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <title>htmltmpl templating engine</title>
    <meta name="author" content="Tomas Styblo (tripie@cpan.org)"></meta>
    <link rel="StyleSheet" type="text/css" href="main.css"></link>
  </head>
  <body>

    <table width="100%" border="2" cellspacing="4" cellpadding="8">
      <tr>
        <td align="center">
          <span class="title">
            <strong>
              htmltmpl: templating engine for separation of code and HTML
            </strong>
          </span>
        </td>
      </tr>
    </table>
    
    <p></p>
    
    <table border="0" cellspacing="0" cellpadding="16">
      <tr>


        <!-- menu on the left -->


        <td valign="top">
          <ul>
            <li><p><a href="http://htmltmpl.sourceforge.net/">HOMEPAGE</a></p></li>
            <li><p><a href="index.html">OVERVIEW</a></p></li>
            <li><p><a href="lang.html">THE LANGUAGE</a></p></li>
            <li><p><a href="python.html">PYTHON VERSION</a></p></li>
            <li><p><a href="easydoc.html">PYTHON EASYDOC</a></p></li>
            <li><p><a href="index.html">JAVA VERSION</a></p></li>
            <li><p><a href="http://lists.sourceforge.net/lists/listinfo/htmltmpl-support">MAILING LIST</a></p></li>
            <li><p><a href="http://sourceforge.net/cvs/?group_id=34229">PUBLIC CVS</a></p></li>
            <li><p><a href="http://sam.tregar.com/html_template.html">HTML::TEMPLATE</a></p></li>
            <li><p><a href="http://sourceforge.net">
                  <img src="http://sourceforge.net/sflogo.php?group_id=34229"
                       width="88" height="31" class="noborder"
                       alt="SourceForge Logo"></img></a></p></li>
          </ul>
        </td>
        

        <!-- the text right to the menu -->

   
        <td valign="top">
          
          <p>
            This is the Python version of htmltmpl. This page contains
            some basic information about the module and examples that
            illustrate its usage.
          </p>
          
          <p>
            <strong>
            A complete documentation of the module's API can be found here.
            </strong>
            It contains description of all public classes and methods which
            the module provides. The documentation is automatically
            generated from docstrings in source file of the module by my
            application <a href="easydoc.html">easydoc</a>, which uses
            htmltmpl and is included in the htmltmpl distribution.
          </p>

          <p>
            Releases 1.15 and up are vastly redesigned to be multitask safe
            and more flexible. The design and interface
            was completely changed to be much more object oriented and
            more maintainable. The downside of this change is that the
            interface is no longer similar to that of HTML::Template.
         </p>
         <p>
            The module is multitask safe in terms of properly synchronized
            accesses to the precompiled templates that are loaded from and
            saved to disk. However, instances of any of its classes should
            <strong>NOT</strong> be shared by multiple threads.
            The only exception are instances of the <em>Template</em> class,
            which can be shared by multiple threads.
          </p>
          <p>
            It would be possible to protect all critical data
            and sections by locks to achieve complete thread safeness, but
            the resulting overhead probably is not worth the effort.
            I hardly can imagine a situation in which someone would want
            or need to share the instances among multiple threads.
            The Java version of htmltmpl, however, aims to be fully
            thread safe.
          </p>

          <ul>
            <li><a href="python-api.html">API documentation</a></li>
            <li><a href="#exceptions">Exceptions</a></li>
            <li><a href="#examples">Examples</a>
              <ul>
                <li><a href="#example-simple">simple</a></li>
                <li><a href="#example-MySQL">MySQL driven</a></li>
              </ul>
            </li>
          </ul>
          
        </td>
      </tr>
    </table>


    <!-- end of the top part -->


    <hr></hr>    
    <h2><a name="constructor"></a>The constructor</h2>
    
    <h3>Parameters:</h3>
    
    <h4>template</h4>
    <p>
      The first mandatory parameter 'template' is a filename of
      the template. The module looks for this file in
      the directories specified by the 'template_path' parameter.
      The 'template_path' parameter must be specified, because
      the module DOES NOT look for the template file in current
      directory.
    </p>
    
    <h4>html_escape</h4>
    <p>
      Optional parameter 'html_escape' is a flag that can
      be used to enable or disable automatic HTML escaping of variables.
      All variables are by default automatically HTML escaped. 
      Escaping escapes HTML brackets, ampersands and double quotes.
    </p>
    
    <h4>global_vars</h4>
    <p>
      Optional parameter 'global_vars' is a flag that can
      be used to specify whether variables which cannot be found in
      the current scope should be looked up in outer scopes.
      Global vars are disabled by default.
    </p>
    
    <h4>include</h4>
    <p>
      Optional parameter 'include' can be used to enable or disable
      TMPL_INCLUDE inclusion of templates. Disabling of inclusion can
      improve performance a little. Inclusion is enabled by default.
    </p>
    
    <h4>strict_case</h4>
    <p>
      Optional parameter 'strict_case' can be used to enable or 
      disable strict verification of case of letters in names of 
      template variables and loops. See section 'Template syntax overview' 
      for description of these rules. Strict case verification is 
      enabled by default.
    </p>
    
    <p>
      You should not disable strict_case. The possibility is provided
      only for compatibility with existing templates for HTML::Template.
    </p>
    
    <p>
      Loop names should not be used in TMPL_VAR statements if strict_case
      is disabled.
    </p>
    
    <h4>max_include</h4>
    <p>
      Optional parameter 'max_include' can be used to specify
      maximum depth of TMPL_INCLUDEs. Max_include defaults
      to 5. This setting prevents infinite recursive inclusions.
    </p>
    
    <h4>precompile</h4>
    <p>
      Optional parameter 'precompile' can be used to enable or disable
      creation and usage of precompiled templates.
      A precompiled template is saved to the
      same directory in which the template is located. You need write
      permissions to that directory. 
    </p>
    
    <p>    
      Precompilation provides a significant performance boost because
      it's not necessary to parse the templates over and over again.
      The boost is especially noticeable during processing of templates
      that include other templates. Comparison of modification times
      of the main template and all included templates is used to
      ensure that the precompiled templates are up-to-date. Templates are also
      recompiled if the htmltmpl module is updated.
    </p>
    
    <p>
      TemplateError is raised when the precompiled template cannot be saved.
      Compilation is enabled by default.
    </p>

    <p>
      Precompilation is available only on UNIX and Windows platforms, because
      proper file locking which is necessary to ensure multitask
      safe behaviour is platform specific and is not implemented 
      on other platforms. Attempts to enable precompilation on the other
      platforms result in TemplateError exception.
    </p>
    
    <h4>comments</h4>
    <p>
      Optional parameter 'comments' can be used to enable or disable
      special template comments "### ". Disabling of comments can improve
      performance a little. Comments are enabled by default.
    </p>
    
    <h4>magic_vars</h4>
    <p>
      Optional parameter 'magic_vars' can be used to enable or disable
      "magic" context variables, that are automatically defined inside
      loops by the module. Magic variables are enabled by default.
    </p>
    
    <h4>debug</h4>
    <p>
      Optional parameter 'debug' is a flag that can be used
      to turn on debugging messages which are printed to stderr.
      Debugging is disabled by default.
    </p>
    

    <hr></hr>
    <h2><a name="methods"></a>Methods</h2>
    
    <h3>set(variable_name, variable_value)</h3>
    <p>
      This method is used to assign values to template identifiers.
    </p>
    
    <p>
      Template identifier can represent either a string or a loop.
      To assign a value to a string identifier pass a scalar
      as the 'variable_value' parameter.
      To assign a value to a loop identifier pass a list of mappings as the
      'variable_value' parameter. The engine iterates over this list and assigns
      values from the mappings to variables in the template if a key in the mapping
      corresponds to a name of a variable in the corresponding loop block.
    </p>
    
    <h3>process()</h3>
    <p>
      This method returns the processed template.
    </p>
    
    <h3>reset()</h3>
    <p>
      This method resets all data set by the __setitem__() method.
      This method must be called after a call to output(), when you
      want to reuse the instance for another processing of the template
      with different data. The template can optionally be cached if you reuse
      the instance (see the 'cache' and 'blind_cache' parameters of 
      the constructor).
    </p>
    
    <h3>Example:</h3>
    
    <pre>
<span class="keyword">from</span> htmltmpl <span class="keyword">import</span> Template
        
<span class="comment"># Create an instance of htmltmpl.
</span>tmpl = Template(template = &quot;<span class="string">foo.tmpl</span>&quot;,
                template_path = [&quot;<span class="string">/my/templates</span>&quot;])
                
<span class="comment"># Assign a string to template variable named &quot;title&quot;.
</span>tmpl[&quot;<span class="string">title</span>&quot;] = &quot;<span class="string">My homepage</span>&quot;
        
<span class="comment"># Assign a loop that consists of two passes to template loop
# named &quot;Customers&quot;. This loop is executed twice, 
# once for each customer.
</span>tmpl[&quot;<span class="string">Customers</span>&quot;] = [
    { &quot;<span class="string">name</span>&quot; : &quot;<span class="string">Joe Sixpack</span>&quot;, &quot;<span class="string">city</span>&quot; : &quot;<span class="string">Los Angeles</span>&quot; },
    { &quot;<span class="string">name</span>&quot; : &quot;<span class="string">Paul Newman</span>&quot;, &quot;<span class="string">city</span>&quot; : &quot;<span class="string">New York</span>&quot; }
]
        
<span class="comment"># Process the template and print the result.
</span><span class="keyword">print</span> tmpl.output()
          </pre>
    
    
    <hr></hr>
    <h2><a name="exceptions"></a>Exceptions</h2>
    
    <h3>TemplateError</h3>
    <p>
      This exception is raised when an error occurs.
      Its argument is a description of the error. It's derived from
      Exception. Errors are either runtime errors (template file not found,
      I/O error...) or template syntax errors. All these errors are fatal. 
      The instance is no longer usable when the exception is raised.
      All IOError exceptions that can be raised on I/O errors are handled
      inside the module and converted to appropriate TemplateError exceptions.
    </p>
    
    <p>
      The exception can be raised by any method and by the constructor.
    </p>
    


    <!-- examples -->



    <hr></hr>
    <h2><a name="examples"></a>Examples</h2>
    
    <p>
      Source files of all these examples are available in 'doc/examples'
      directory of the distribution. Files from the regression test
      suite (the 'test' directory) can also serve as examples.
    </p>

    <p>
      <small>
        FAQ: Emacs (the 'htmlize-file' command) is used to colorify
        the source code examples.
      </small>
    </p>

    <h3><a name="example-simple"></a>simple:</h3>

    <h4>template.tmpl</h4>
    <pre>
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;<span class="red">&lt;TMPL_VAR title&gt;</span>&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;Customers:&lt;/h1&gt;
        &lt;p&gt;
            Total: <span class="red">&lt;TMPL_VAR Customers&gt;</span> 
        &lt;/p&gt;

        <span class="red">### this comment will be removed</span>

        &lt;table&gt;
            <span class="red">&lt;TMPL_LOOP Customers&gt;</span>
                &lt;tr&gt;
                    <span class="red">&lt;TMPL_IF new&gt;</span>
                        &lt;td&gt;new customer&lt;/td&gt; 
                    <span class="red">&lt;TMPL_ELSE&gt;</span>
                        &lt;td&gt;old customer&lt;/td&gt;
                    <span class="red">&lt;/TMPL_IF&gt;</span>
                    &lt;td&gt;<span class="red">&lt;TMPL_VAR __PASS__&gt;</span>&lt;/td&gt;
                    &lt;td&gt;<span class="red">&lt;TMPL_VAR name&gt;</span>&lt;/td&gt;
                    &lt;td&gt;<span class="red">&lt;TMPL_VAR city&gt;</span>&lt;/td&gt;
                &lt;/tr&gt;
            <span class="red">&lt;/TMPL_LOOP&gt;</span>
        &lt;/table&gt;
    &lt;/body&gt;
&lt;/html&gt;
    </pre>
          
    <h4>template.py</h4>
    <pre>
<span class="keyword">from</span> htmltmpl <span class="keyword">import</span> TemplateManager, TemplateProcessor

<span class="comment"># Compile or load already precompiled template.
</span>template = TemplateManager().prepare(&quot;<span class="string">template.tmpl</span>&quot;)
tproc = TemplateProcessor()

<span class="comment"># Set the title.
</span>tproc.set(&quot;<span class="string">title</span>&quot;, &quot;<span class="string">Our customers</span>&quot;)

<span class="comment"># Create the 'Customers' loop.
</span>customers = []

<span class="comment"># First customer.
</span>customer = {}
customer[&quot;<span class="string">name</span>&quot;] = &quot;<span class="string">Joe Sixpack</span>&quot;
customer[&quot;<span class="string">city</span>&quot;] = &quot;<span class="string">Los Angeles</span>&quot;
customer[&quot;<span class="string">new</span>&quot;] = 0
customers.append(customer)

<span class="comment"># Second customer.
</span>customer = {}
customer[&quot;<span class="string">name</span>&quot;] = &quot;<span class="string">Paul Newman</span>&quot;
customer[&quot;<span class="string">city</span>&quot;] = &quot;<span class="string">New York</span>&quot;
customer[&quot;<span class="string">new</span>&quot;] = 1
customers.append(customer)

tproc.set(&quot;<span class="string">Customers</span>&quot;, customers)

<span class="comment"># Print the processed template.
</span><span class="keyword">print</span> tproc.process(template)
    </pre>
          
    <h4>template.html</h4>
    <pre>
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Our customers&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;Customers:&lt;/h1&gt;
        &lt;p&gt;
            Total: 2
        &lt;/p&gt;



        &lt;table&gt;
            &lt;tr&gt;
                    &lt;td&gt;old customer&lt;/td&gt;
                &lt;td&gt;1&lt;/td&gt;
                &lt;td&gt;Joe Sixpack&lt;/td&gt;
                &lt;td&gt;Los Angeles&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                    &lt;td&gt;new customer&lt;/td&gt;
                &lt;td&gt;2&lt;/td&gt;
                &lt;td&gt;Paul Newman&lt;/td&gt;
                &lt;td&gt;New York&lt;/td&gt;
            &lt;/tr&gt;                
        &lt;/table&gt;
    &lt;/body&gt;
&lt;/html&gt;
    </pre>
          


    <!-- example: database driven -->
    

    <hr></hr>
    <h3><a name="example-MySQL"></a>MySQL driven:</h3>       
    
    <h4>products.tmpl</h4>
    <pre>
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;<span class="red">&lt;TMPL_VAR title&gt;</span>&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;

    &lt;h1&gt;Our products&lt;/h1&gt;

    &lt;table&gt;
        <span class="red">&lt;TMPL_LOOP Products&gt;</span>
            &lt;tr&gt;
                &lt;td&gt;<span class="red">&lt;TMPL_VAR id&gt;</span>&lt;/td&gt;
                &lt;td&gt;<span class="red">&lt;TMPL_VAR name&gt;</span>&lt;/td&gt;
            &lt;/tr&gt;
        <span class="red">&lt;/TMPL_LOOP&gt;</span>
    &lt;/table&gt;

    &lt;/body&gt;
&lt;/html&gt;
    </pre>
    
    
    <h4>products.py</h4>
    <pre>
<span class="keyword">import</span> MySQLdb
<span class="keyword">import</span> MySQLdb.cursors
<span class="keyword">from</span> htmltmpl <span class="keyword">import</span> TemplateManager, TemplateProcessor

<span class="comment"># Define some constants.
</span>DB = &quot;<span class="string">test</span>&quot;
USER = &quot;&quot;
PASSWD = &quot;&quot;
TABLE = &quot;&quot;&quot;<span class="string">

    CREATE TABLE IF NOT EXISTS Products (
        id            INTEGER        NOT NULL AUTO_INCREMENT,
        name          VARCHAR(255)   NOT NULL,
        CONSTRAINT pkey_id
            PRIMARY KEY(id)
    )
    
</span>&quot;&quot;&quot;

template = TemplateManager().prepare(&quot;<span class="string">products.tmpl</span>&quot;)
tproc = TemplateProcessor()
                
<span class="comment"># Assign a string to template variable named &quot;title&quot;.
</span>tproc.set(&quot;<span class="string">title</span>&quot;, &quot;<span class="string">Our products</span>&quot;)
        
<span class="comment"># Connect the database. Create the table.
</span>db = MySQLdb.connect(db = DB, user = USER, passwd = PASSWD,
                     cursorclass = MySQLdb.cursors.DictCursor)
create_cur = db.cursor()
create_cur.execute(TABLE)
create_cur.close()

<span class="comment"># Insert some data.
</span>insert_cur = db.cursor()
insert_cur.executemany(&quot;&quot;&quot;<span class="string">

    INSERT INTO Products (name) VALUES (%(name)s)

</span>&quot;&quot;&quot;, [
    {&quot;<span class="string">name</span>&quot;: &quot;<span class="string">Seagate</span>&quot;},
    {&quot;<span class="string">name</span>&quot;: &quot;<span class="string">Conner</span>&quot;},
    {&quot;<span class="string">name</span>&quot;: &quot;<span class="string">Maxtor</span>&quot;}
])
insert_cur.close()


<span class="comment"># Select the products.
</span>products_cur = db.cursor()
products_cur.execute(&quot;&quot;&quot;<span class="string">

    SELECT id, name
    FROM Products
    
</span>&quot;&quot;&quot;)

<span class="comment"># Append product data in form of mappings (dictionaries) to the
# products list.
</span>products = []
<span class="keyword">for</span> i <span class="keyword">in</span> range(products_cur.rowcount):
    products.append(products_cur.fetchone())
products_cur.close()
db.close()

<span class="comment"># Assign the products list to template loop identifier 'Products'.
# NOTE: htmltmpl automatically converts all the values
# to strings using str().
</span>tproc.set(&quot;<span class="string">Products</span>&quot;, products)
        
<span class="comment"># Process the template and print the result.
</span><span class="keyword">print</span> tproc.process(template)
    </pre>

    <h4>products.html</h4>

    <pre>
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Our products&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;

        &lt;h1&gt;Our products&lt;/h1&gt;

        &lt;table&gt;
                &lt;tr&gt;
                    &lt;td&gt;1&lt;/td&gt;
                    &lt;td&gt;Seagate&lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td&gt;2&lt;/td&gt;
                    &lt;td&gt;Conner&lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td&gt;3&lt;/td&gt;
                    &lt;td&gt;Maxtor&lt;/td&gt;
                &lt;/tr&gt;
        &lt;/table&gt;

    &lt;/body&gt;
&lt;/html&gt;
    </pre>
    
  </body>
</html>
